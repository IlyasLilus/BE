<!DOCTYPE html>
<html>
<head>
    <style>
        #drag-items {
            position: absolute;
            bottom: 0;
            left: 0;
            display: flex;
        }
        .draggable {
            width: 50px;
            height: 50px;
            margin: 10px;
        }
        #pc {
            background-image: url("image/desktop-computer.svg");
            background-size: cover;
        }
        #router {
            background-image: url("image/cisco-router-icon.webp");
            background-size:cover
        }
        #wire {
            background-image: url("image/cable.svg");
            background-size: cover;
        }
        #context-menu {
            display: none;
            position: absolute;
            width: 100px;
            background-color: #fff;
            border: 1px solid #ddd;
        }
        #context-menu button {
            all: unset;
            width: 100%;
            padding: 5px;
        }

        .draggable.clone {
            background-color: #ccc;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/interactjs@1.10.11/dist/interact.min.js"></script>
</head>
<body>

<div id="drag-items">
    <div id="pc" class="draggable"></div>
    <div id="router" class="draggable"></div>
    <div id="wire" class="draggable"></div>
</div>

<div id="context-menu">
    <button id="configurer">Configurer...</button>
    <button id="delete">Supprimer</button>
    <button id="cloner">Cloner</button>
</div>

<script>
    const contextMenu = document.getElementById('context-menu');
    const deleteButton = document.getElementById('delete');
    const clonerButton = document.getElementById('cloner');
    let selectedElement = null;

    interact('.draggable')
        .draggable({
            inertia: true,
            autoScroll: true,
            onmove: dragMoveListener,
            onend: function (event) {
                if (!event.target.classList.contains('clone')) {
                    const clone = event.target.cloneNode();
                    clone.classList.add('clone');
                    clone.style.transform = 'none';
                    document.body.appendChild(clone);
                    interact(clone)
                        .draggable({
                            inertia: true,
                            autoScroll: true,
                            onmove: dragMoveListener
                        });
                    event.target.parentNode.insertBefore(clone, event.target.nextSibling);
                }
            }
        })
        .on('doubletap', function (event) {
            selectedElement = event.target;
            contextMenu.style.display = 'block';
            contextMenu.style.left = `${event.pageX}px`;
            contextMenu.style.top = `${event.pageY}px`;
            event.preventDefault();
        });
    
    deleteButton.addEventListener('click', function () {
        selectedElement.style.transform = 'none';
        selectedElement.parentNode.removeChild(selectedElement);
        contextMenu.style.display = 'none';
    });

    clonerButton.addEventListener('click', function () {
        const clone = selectedElement.cloneNode();
        clone.classList.add('clone');
        const x = selectedElement.getAttribute('data-x') || 0;
        const y = selectedElement.getAttribute('data-y') || 0;
        clone.style.transform = `translate(${x}px, ${y}px)`;
        document.body.appendChild(clone);
        interact(clone)
            .draggable({
                inertia: true,
                autoScroll: true,
                onmove: dragMoveListener
            });
        selectedElement.parentNode.insertBefore(clone, selectedElement.nextSibling);
        contextMenu.style.display = 'none';
    });

    function dragMoveListener (event) {
        var target = event.target,
            x = (parseFloat(target.getAttribute('data-x')) || 0) + event.dx,
            y = (parseFloat(target.getAttribute('data-y')) || 0) + event.dy;

        target.style.webkitTransform =
        target.style.transform =
            'translate(' + x + 'px, ' + y + 'px)';

        target.setAttribute('data-x', x);
        target.setAttribute('data-y', y);
    }
</script>

</body>
</html>